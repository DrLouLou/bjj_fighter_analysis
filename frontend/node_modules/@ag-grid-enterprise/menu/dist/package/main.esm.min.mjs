var K=Object.defineProperty,re=Object.defineProperties,ne=Object.getOwnPropertyDescriptor,ie=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,se=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,j=(t,e,o)=>e in t?K(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,F=(t,e)=>{for(var o in e||(e={}))se.call(e,o)&&j(t,o,e[o]);if($)for(var o of $(e))ae.call(e,o)&&j(t,o,e[o]);return t},V=(t,e)=>re(t,ie(e)),l=(t,e,o,r)=>{for(var n=r>1?void 0:r?ne(e,o):e,i=t.length-1,s;i>=0;i--)(s=t[i])&&(n=(r?s(e,o,n):s(n))||n);return r&&n&&K(e,o,n),n};import{ModuleNames as le}from"@ag-grid-community/core";import{EnterpriseCoreModule as ue}from"@ag-grid-enterprise/core";import{_ as z,Autowired as M,Bean as ce,BeanStub as H,ModuleNames as de,ModuleRegistry as pe,PostConstruct as q,RefSelector as he,AgPromise as W,TabbedLayout as me,AgMenuItemComponent as J,Component as ge,Events as Ce,FilterWrapperComp as ve}from"@ag-grid-community/core";var y=class extends H{hideActiveMenu(){this.destroyBean(this.activeMenu)}showMenuAfterMouseEvent(t,e,o,r){const n=r?"filterMenuTab":void 0;this.showMenu(t,i=>{var s;const a=i.getGui();this.popupService.positionPopupUnderMouseEvent({type:o,column:t,mouseEvent:e,ePopup:a}),n&&((s=i.showTab)==null||s.call(i,n)),this.dispatchVisibleChangedEvent(!0,!1,t,n)},o,n,void 0,e.target)}showMenuAfterButtonClick(t,e,o,r){let n=-1,i="left";this.gos.get("enableRtl")&&(n=1,i="right");const s=r?"filterMenuTab":void 0,a=s?[s]:void 0,c=this.menuService.isLegacyMenuEnabled();let m=(c?9:4)*n,g=c?-23:4;this.showMenu(t,d=>{var p;const u=d.getGui();this.popupService.positionPopupByComponent({type:o,column:t,eventSource:e,ePopup:u,alignSide:i,nudgeX:m,nudgeY:g,position:"under",keepWithinBounds:!0}),s&&((p=d.showTab)==null||p.call(d,s)),this.dispatchVisibleChangedEvent(!0,!1,t,s)},o,s,a,e)}showMenu(t,e,o,r,n,i){var s;const{menu:a,eMenuGui:c,anchorToElement:m,restoreFocusParams:g}=this.getMenuParams(t,n,i),d=[];d.push(u=>{const f=a.getGui();this.destroyBean(a),t&&(t.setMenuVisible(!1,"contextMenu"),this.menuUtils.restoreFocusOnClose(g,f,u))});const p=this.localeService.getLocaleTextFunc();if(this.popupService.addPopup({modal:!0,eChild:c,closeOnEsc:!0,closedCallback:u=>{d.forEach(f=>f(u)),this.dispatchVisibleChangedEvent(!1,!1,t,r)},afterGuiAttached:u=>a.afterGuiAttached(Object.assign({},{container:o},u)),positionCallback:r?()=>e(a):void 0,ariaLabel:p("ariaLabelColumnMenu","Column Menu")}),r||((s=a.showTabBasedOnPreviousSelection)==null||s.call(a),e(a)),this.menuService.isColumnMenuAnchoringEnabled()){const u=this.popupService.setPopupPositionRelatedToElement(c,m);u&&t&&this.addStopAnchoring(u,t,d)}a.addEventListener(x.EVENT_TAB_SELECTED,u=>{this.dispatchVisibleChangedEvent(!1,!0,t),this.lastSelectedTab=u.key,this.dispatchVisibleChangedEvent(!0,!0,t)}),t?.setMenuVisible(!0,"contextMenu"),this.activeMenu=a,a.addEventListener(H.EVENT_DESTROYED,()=>{this.activeMenu===a&&(this.activeMenu=null)})}addStopAnchoring(t,e,o){t.then(r=>{e.addEventListener("leftChanged",r),e.addEventListener("visibleChanged",r),o.push(()=>{e.removeEventListener("leftChanged",r),e.removeEventListener("visibleChanged",r)})})}getMenuParams(t,e,o){const r={column:t,headerPosition:this.focusService.getFocusedHeader(),columnIndex:this.columnModel.getAllDisplayedColumns().indexOf(t),eventSource:o},n=this.createMenu(t,r,e,o);return{menu:n,eMenuGui:n.getGui(),anchorToElement:o||this.ctrlsService.getGridBodyCtrl().getGui(),restoreFocusParams:r}}createMenu(t,e,o,r){return this.menuService.isLegacyMenuEnabled()?this.createBean(new x(t,e,this.lastSelectedTab,o,r)):this.createBean(new P(t,e,r))}dispatchVisibleChangedEvent(t,e,o,r){var n,i;const s={type:Ce.EVENT_COLUMN_MENU_VISIBLE_CHANGED,visible:t,switchingTab:e,key:(i=(n=this.lastSelectedTab)!=null?n:r)!=null?i:this.menuService.isLegacyMenuEnabled()?x.TAB_GENERAL:"columnMenu",column:o??null};this.eventService.dispatchEvent(s)}isMenuEnabled(t){var e;if(!this.menuService.isLegacyMenuEnabled())return!0;const o=!this.filterManager.isFilterAllowed(t),r=(e=t.getColDef().menuTabs)!=null?e:x.TABS_DEFAULT;return(o&&r.includes(x.TAB_FILTER)?r.length-1:r.length)>0}showMenuAfterContextMenuEvent(t,e,o){this.menuUtils.onContextMenu(e,o,r=>(this.showMenuAfterMouseEvent(t,r,"columnMenu"),!0))}};l([M("popupService")],y.prototype,"popupService",2),l([M("focusService")],y.prototype,"focusService",2),l([M("ctrlsService")],y.prototype,"ctrlsService",2),l([M("columnModel")],y.prototype,"columnModel",2),l([M("filterManager")],y.prototype,"filterManager",2),l([M("menuUtils")],y.prototype,"menuUtils",2),l([M("menuService")],y.prototype,"menuService",2),y=l([ce("enterpriseMenuFactory")],y);var b=class h extends H{constructor(e,o,r,n,i){super(),this.column=e,this.restoreFocusParams=o,this.initialSelection=r,this.restrictTo=n,this.sourceElement=i,this.tabFactories={},this.includeChecks={},this.tabFactories[h.TAB_GENERAL]=this.createMainPanel.bind(this),this.tabFactories[h.TAB_FILTER]=this.createFilterPanel.bind(this),this.tabFactories[h.TAB_COLUMNS]=this.createColumnsPanel.bind(this),this.includeChecks[h.TAB_GENERAL]=()=>!0,this.includeChecks[h.TAB_FILTER]=()=>e?this.filterManager.isFilterAllowed(e):!1,this.includeChecks[h.TAB_COLUMNS]=()=>!0}init(){const e=this.getTabsToCreate().map(o=>this.createTab(o));this.tabbedLayout=new me({items:e,cssClass:"ag-menu",onActiveItemClicked:this.onHidePopup.bind(this),onItemClicked:this.onTabItemClicked.bind(this)}),this.createBean(this.tabbedLayout),this.mainMenuList&&this.mainMenuList.setParentComponent(this.tabbedLayout),this.addDestroyFunc(()=>this.destroyBean(this.tabbedLayout))}getTabsToCreate(){var e,o;return this.restrictTo?this.restrictTo:((o=(e=this.column)==null?void 0:e.getColDef().menuTabs)!=null?o:h.TABS_DEFAULT).filter(r=>this.isValidMenuTabItem(r)).filter(r=>this.isNotSuppressed(r)).filter(r=>this.isModuleLoaded(r))}isModuleLoaded(e){return e===h.TAB_COLUMNS?pe.__isRegistered(de.ColumnsToolPanelModule,this.context.getGridId()):!0}isValidMenuTabItem(e){let o=!0,r=h.TABS_DEFAULT;return this.restrictTo!=null&&(o=this.restrictTo.indexOf(e)>-1,r=this.restrictTo),o=o&&h.TABS_DEFAULT.indexOf(e)>-1,o||console.warn(`AG Grid: Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of [${r}]`),o}isNotSuppressed(e){return this.includeChecks[e]()}createTab(e){return this.tabFactories[e]()}showTabBasedOnPreviousSelection(){this.showTab(this.initialSelection)}showTab(e){this.tabItemColumns&&e===h.TAB_COLUMNS?this.tabbedLayout.showItem(this.tabItemColumns):this.tabItemFilter&&e===h.TAB_FILTER?this.tabbedLayout.showItem(this.tabItemFilter):this.tabItemGeneral&&e===h.TAB_GENERAL?this.tabbedLayout.showItem(this.tabItemGeneral):this.tabbedLayout.showFirstItem()}onTabItemClicked(e){let o=null;switch(e.item){case this.tabItemColumns:o=h.TAB_COLUMNS;break;case this.tabItemFilter:o=h.TAB_FILTER;break;case this.tabItemGeneral:o=h.TAB_GENERAL;break}o&&this.activateTab(o)}activateTab(e){const o={type:h.EVENT_TAB_SELECTED,key:e};this.dispatchEvent(o)}createMainPanel(){return this.mainMenuList=this.columnMenuFactory.createMenu(this,this.column,()=>{var e;return(e=this.sourceElement)!=null?e:this.getGui()}),this.mainMenuList.addEventListener(J.EVENT_CLOSE_MENU,this.onHidePopup.bind(this)),this.tabItemGeneral={title:z.createIconNoSpan("menu",this.gos,this.column),titleLabel:h.TAB_GENERAL.replace("MenuTab",""),bodyPromise:W.resolve(this.mainMenuList.getGui()),name:h.TAB_GENERAL},this.tabItemGeneral}onHidePopup(e){this.menuUtils.closePopupAndRestoreFocusOnSelect(this.hidePopupFunc,this.restoreFocusParams,e)}createFilterPanel(){const e=this.column?this.createManagedBean(new ve(this.column,"COLUMN_MENU")):null;if(!e?.hasFilter())throw new Error("AG Grid - Unable to instantiate filter");const o=n=>e.afterGuiAttached(n),r=()=>e.afterGuiDetached();return this.tabItemFilter={title:z.createIconNoSpan("filter",this.gos,this.column),titleLabel:h.TAB_FILTER.replace("MenuTab",""),bodyPromise:W.resolve(e?.getGui()),afterAttachedCallback:o,afterDetachedCallback:r,name:h.TAB_FILTER},this.tabItemFilter}createColumnsPanel(){const e=document.createElement("div");e.classList.add("ag-menu-column-select-wrapper");const r=this.columnChooserFactory.createColumnSelectPanel(this,this.column).getGui();return r.classList.add("ag-menu-column-select"),e.appendChild(r),this.tabItemColumns={title:z.createIconNoSpan("columns",this.gos,this.column),titleLabel:h.TAB_COLUMNS.replace("MenuTab",""),bodyPromise:W.resolve(e),name:h.TAB_COLUMNS},this.tabItemColumns}afterGuiAttached(e){const{container:o,hidePopup:r}=e;this.tabbedLayout.setAfterAttachedParams({container:o,hidePopup:r}),r&&(this.hidePopupFunc=r,this.addDestroyFunc(r))}getGui(){return this.tabbedLayout.getGui()}};b.EVENT_TAB_SELECTED="tabSelected",b.TAB_FILTER="filterMenuTab",b.TAB_GENERAL="generalMenuTab",b.TAB_COLUMNS="columnsMenuTab",b.TABS_DEFAULT=[b.TAB_GENERAL,b.TAB_FILTER,b.TAB_COLUMNS],l([M("filterManager")],b.prototype,"filterManager",2),l([M("columnChooserFactory")],b.prototype,"columnChooserFactory",2),l([M("columnMenuFactory")],b.prototype,"columnMenuFactory",2),l([M("menuUtils")],b.prototype,"menuUtils",2),l([q],b.prototype,"init",1);var x=b,P=class extends ge{constructor(t,e,o){super(`
            <div ref="eColumnMenu" role="presentation" class="ag-menu ag-column-menu"></div>
        `),this.column=t,this.restoreFocusParams=e,this.sourceElement=o}init(){this.mainMenuList=this.columnMenuFactory.createMenu(this,this.column,()=>{var t;return(t=this.sourceElement)!=null?t:this.getGui()}),this.mainMenuList.addEventListener(J.EVENT_CLOSE_MENU,this.onHidePopup.bind(this)),this.eColumnMenu.appendChild(this.mainMenuList.getGui())}onHidePopup(t){this.menuUtils.closePopupAndRestoreFocusOnSelect(this.hidePopupFunc,this.restoreFocusParams,t)}afterGuiAttached({hidePopup:t}){t&&(this.hidePopupFunc=t,this.addDestroyFunc(t)),this.focusService.focusInto(this.mainMenuList.getGui())}};l([M("columnMenuFactory")],P.prototype,"columnMenuFactory",2),l([M("menuUtils")],P.prototype,"menuUtils",2),l([M("focusService")],P.prototype,"focusService",2),l([he("eColumnMenu")],P.prototype,"eColumnMenu",2),l([q],P.prototype,"init",1);import{_ as N,AgMenuItemComponent as Q,AgMenuList as Me,Autowired as G,Bean as be,BeanStub as Z,Component as fe,ModuleNames as D,ModuleRegistry as O,Optional as Se,PostConstruct as ye,Events as Ae}from"@ag-grid-community/core";var Ee="ag-menu",ee="ag-context-menu-open",_=class extends Z{hideActiveMenu(){this.destroyBean(this.activeMenu)}getMenuItems(t,e,o){const r=[];if(N.exists(t)&&O.__isRegistered(D.ClipboardModule,this.context.getGridId())&&e&&(this.gos.get("suppressCutToClipboard")||r.push("cut"),r.push("copy","copyWithHeaders","copyWithGroupHeaders","paste","separator")),this.gos.get("enableCharts")&&O.__isRegistered(D.GridChartsModule,this.context.getGridId())&&(this.columnModel.isPivotMode()&&r.push("pivotChart"),this.rangeService&&!this.rangeService.isEmpty()&&r.push("chartRange")),N.exists(t)){const a=!O.__isRegistered(D.CsvExportModule,this.context.getGridId()),c=!O.__isRegistered(D.ExcelExportModule,this.context.getGridId()),m=this.gos.get("suppressExcelExport")||c,g=this.gos.get("suppressCsvExport")||a;!N.isIOSUserAgent()&&(!m||!g)&&r.push("export")}const n=r.length?r:void 0,i=e?.getColDef().contextMenuItems;if(Array.isArray(i))return i;if(typeof i=="function")return i(this.gos.addGridCommonParams({column:e,node:t,value:o,defaultItems:n}));const s=this.gos.getCallback("getContextMenuItems");return s?s({column:e,node:t,value:o,defaultItems:n}):r}onContextMenu(t,e,o,r,n,i){this.menuUtils.onContextMenu(t,e,s=>this.showMenu(o,r,n,s,i))}showMenu(t,e,o,r,n){const i=this.getMenuItems(t,e,o),s=this.ctrlsService.getGridBodyCtrl().getGui();if(i===void 0||N.missingOrEmpty(i))return!1;const a=new k(i,e,t,o);this.createBean(a);const c=a.getGui(),m={column:e,rowNode:t,type:"contextMenu",mouseEvent:r,ePopup:c,nudgeY:1},g=this.localeService.getLocaleTextFunc(),d=this.popupService.addPopup({modal:!0,eChild:c,closeOnEsc:!0,closedCallback:u=>{s.classList.remove(ee),this.destroyBean(a),this.dispatchVisibleChangedEvent(!1,u===void 0?"api":"ui")},click:r,positionCallback:()=>{const u=this.gos.get("enableRtl");this.popupService.positionPopupUnderMouseEvent(V(F({},m),{nudgeX:u?(c.offsetWidth+1)*-1:1}))},anchorToElement:n,ariaLabel:g("ariaLabelContextMenu","Context Menu")});d&&(s.classList.add(ee),a.afterGuiAttached({container:"contextMenu",hidePopup:d.hideFunc})),this.activeMenu&&this.hideActiveMenu(),this.activeMenu=a,a.addEventListener(Z.EVENT_DESTROYED,()=>{this.activeMenu===a&&(this.activeMenu=null)}),d&&a.addEventListener(Q.EVENT_CLOSE_MENU,u=>{var f,T;return d.hideFunc({mouseEvent:(f=u.mouseEvent)!=null?f:void 0,keyboardEvent:(T=u.keyboardEvent)!=null?T:void 0,forceHide:!0})});const p=r&&r instanceof MouseEvent&&r.type==="mousedown";return this.dispatchVisibleChangedEvent(!0,p?"api":"ui"),!0}dispatchVisibleChangedEvent(t,e="ui"){const o={type:Ae.EVENT_CONTEXT_MENU_VISIBLE_CHANGED,visible:t,source:e};this.eventService.dispatchEvent(o)}};l([G("popupService")],_.prototype,"popupService",2),l([G("ctrlsService")],_.prototype,"ctrlsService",2),l([G("columnModel")],_.prototype,"columnModel",2),l([G("menuUtils")],_.prototype,"menuUtils",2),l([Se("rangeService")],_.prototype,"rangeService",2),_=l([be("contextMenuFactory")],_);var k=class extends fe{constructor(t,e,o,r){super(`<div class="${Ee}" role="presentation"></div>`),this.menuItems=t,this.column=e,this.node=o,this.value=r,this.menuList=null,this.focusedCell=null}addMenuItems(){const t=this.createManagedBean(new Me(0,{column:this.column,node:this.node,value:this.value})),e=this.menuItemMapper.mapWithStockItems(this.menuItems,null,()=>this.getGui());t.addMenuItems(e),this.appendChild(t),this.menuList=t,t.addEventListener(Q.EVENT_CLOSE_MENU,o=>this.dispatchEvent(o))}afterGuiAttached(t){t.hidePopup&&this.addDestroyFunc(t.hidePopup),this.focusedCell=this.focusService.getFocusedCell(),this.menuList&&this.focusService.focusInto(this.menuList.getGui())}restoreFocusedCell(){const t=this.focusService.getFocusedCell();if(t&&this.focusedCell&&this.cellPositionUtils.equals(t,this.focusedCell)){const{rowIndex:e,rowPinned:o,column:r}=this.focusedCell,n=this.gos.getDocument(),i=this.gos.getActiveDomElement();(!i||i===n.body)&&this.focusService.setFocusedCell({rowIndex:e,column:r,rowPinned:o,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!this.focusService.isKeyboardMode()})}}destroy(){this.restoreFocusedCell(),super.destroy()}};l([G("menuItemMapper")],k.prototype,"menuItemMapper",2),l([G("focusService")],k.prototype,"focusService",2),l([G("cellPositionUtils")],k.prototype,"cellPositionUtils",2),l([ye],k.prototype,"addMenuItems",1);import{_ as C,Autowired as L,Bean as _e,BeanStub as Te,ModuleNames as A,ModuleRegistry as E,Optional as te}from"@ag-grid-community/core";var S=class extends Te{mapWithStockItems(t,e,o){if(!t)return[];const r=[];return t.forEach(n=>{let i;if(typeof n=="string"?i=this.getStockMenuItem(n,e,o):i=F({},n),!i)return;const s=i,{subMenu:a}=s;a&&a instanceof Array&&(s.subMenu=this.mapWithStockItems(a,e,o)),i!=null&&r.push(i)}),r}getStockMenuItem(t,e,o){var r;const n=this.localeService.getLocaleTextFunc(),i=this.gos.get("skipHeaderOnAutoSize");switch(t){case"pinSubMenu":return{name:n("pinColumn","Pin Column"),icon:C.createIconNoSpan("menuPin",this.gos,null),subMenu:["clearPinned","pinLeft","pinRight"]};case"pinLeft":return{name:n("pinLeft","Pin Left"),action:()=>this.columnModel.setColumnsPinned([e],"left","contextMenu"),checked:!!e&&e.isPinnedLeft()};case"pinRight":return{name:n("pinRight","Pin Right"),action:()=>this.columnModel.setColumnsPinned([e],"right","contextMenu"),checked:!!e&&e.isPinnedRight()};case"clearPinned":return{name:n("noPin","No Pin"),action:()=>this.columnModel.setColumnsPinned([e],null,"contextMenu"),checked:!!e&&!e.isPinned()};case"valueAggSubMenu":return E.__assertRegistered(A.RowGroupingModule,"Aggregation from Menu",this.context.getGridId())?!e?.isPrimary()&&!e?.getColDef().pivotValueColumn?null:{name:n("valueAggregation","Value Aggregation"),icon:C.createIconNoSpan("menuValue",this.gos,null),subMenu:this.createAggregationSubMenu(e,this.aggFuncService)}:null;case"autoSizeThis":return{name:n("autosizeThiscolumn","Autosize This Column"),action:()=>this.columnModel.autoSizeColumn(e,"contextMenu",i)};case"autoSizeAll":return{name:n("autosizeAllColumns","Autosize All Columns"),action:()=>this.columnModel.autoSizeAllColumns("contextMenu",i)};case"rowGroup":return{name:n("groupBy","Group by")+" "+C.escapeString(this.columnModel.getDisplayNameForColumn(e,"header")),disabled:e?.isRowGroupActive()||!e?.getColDef().enableRowGroup,action:()=>this.columnModel.addRowGroupColumns([e],"contextMenu"),icon:C.createIconNoSpan("menuAddRowGroup",this.gos,null)};case"rowUnGroup":const s=C.createIconNoSpan("menuRemoveRowGroup",this.gos,null),a=e?.getColDef().showRowGroup,c=this.gos.get("groupLockGroupColumns");if(a===!0)return{name:n("ungroupAll","Un-Group All"),disabled:c===-1||c>=this.columnModel.getRowGroupColumns().length,action:()=>this.columnModel.setRowGroupColumns(this.columnModel.getRowGroupColumns().slice(0,c),"contextMenu"),icon:s};if(typeof a=="string"){const p=this.columnModel.getPrimaryColumn(a),u=p!=null?C.escapeString(this.columnModel.getDisplayNameForColumn(p,"header")):a;return{name:n("ungroupBy","Un-Group by")+" "+u,disabled:p!=null&&this.columnModel.isColumnGroupingLocked(p),action:()=>this.columnModel.removeRowGroupColumns([a],"contextMenu"),icon:s}}return{name:n("ungroupBy","Un-Group by")+" "+C.escapeString(this.columnModel.getDisplayNameForColumn(e,"header")),disabled:!e?.isRowGroupActive()||!e?.getColDef().enableRowGroup||this.columnModel.isColumnGroupingLocked(e),action:()=>this.columnModel.removeRowGroupColumns([e],"contextMenu"),icon:s};case"resetColumns":return{name:n("resetColumns","Reset Columns"),action:()=>this.columnModel.resetColumnState("contextMenu")};case"expandAll":return{name:n("expandAll","Expand All Row Groups"),action:()=>this.gridApi.expandAll()};case"contractAll":return{name:n("collapseAll","Collapse All Row Groups"),action:()=>this.gridApi.collapseAll()};case"copy":return E.__assertRegistered(A.ClipboardModule,"Copy from Menu",this.context.getGridId())?{name:n("copy","Copy"),shortcut:n("ctrlC","Ctrl+C"),icon:C.createIconNoSpan("clipboardCopy",this.gos,null),action:()=>this.clipboardService.copyToClipboard()}:null;case"copyWithHeaders":return E.__assertRegistered(A.ClipboardModule,"Copy with Headers from Menu",this.context.getGridId())?{name:n("copyWithHeaders","Copy with Headers"),icon:C.createIconNoSpan("clipboardCopy",this.gos,null),action:()=>this.clipboardService.copyToClipboard({includeHeaders:!0})}:null;case"copyWithGroupHeaders":return E.__assertRegistered(A.ClipboardModule,"Copy with Group Headers from Menu",this.context.getGridId())?{name:n("copyWithGroupHeaders","Copy with Group Headers"),icon:C.createIconNoSpan("clipboardCopy",this.gos,null),action:()=>this.clipboardService.copyToClipboard({includeHeaders:!0,includeGroupHeaders:!0})}:null;case"cut":if(E.__assertRegistered(A.ClipboardModule,"Cut from Menu",this.context.getGridId())){const p=this.focusService.getFocusedCell(),u=p?this.rowPositionUtils.getRowNode(p):null,f=u?p?.column.isCellEditable(u):!1;return{name:n("cut","Cut"),shortcut:n("ctrlX","Ctrl+X"),icon:C.createIconNoSpan("clipboardCut",this.gos,null),disabled:!f||this.gos.get("suppressCutToClipboard"),action:()=>this.clipboardService.cutToClipboard(void 0,"contextMenu")}}else return null;case"paste":return E.__assertRegistered(A.ClipboardModule,"Paste from Clipboard",this.context.getGridId())?{name:n("paste","Paste"),shortcut:n("ctrlV","Ctrl+V"),disabled:!0,icon:C.createIconNoSpan("clipboardPaste",this.gos,null),action:()=>this.clipboardService.pasteFromClipboard()}:null;case"export":const m=[],g=E.__isRegistered(A.CsvExportModule,this.context.getGridId()),d=E.__isRegistered(A.ExcelExportModule,this.context.getGridId());return!this.gos.get("suppressCsvExport")&&g&&m.push("csvExport"),!this.gos.get("suppressExcelExport")&&d&&m.push("excelExport"),{name:n("export","Export"),subMenu:m,icon:C.createIconNoSpan("save",this.gos,null)};case"csvExport":return{name:n("csvExport","CSV Export"),icon:C.createIconNoSpan("csvExport",this.gos,null),action:()=>this.gridApi.exportDataAsCsv({})};case"excelExport":return{name:n("excelExport","Excel Export"),icon:C.createIconNoSpan("excelExport",this.gos,null),action:()=>this.gridApi.exportDataAsExcel()};case"separator":return"separator";case"pivotChart":case"chartRange":return(r=this.chartMenuItemMapper.getChartItems(t))!=null?r:null;case"columnFilter":return e?{name:n("columnFilter","Column Filter"),icon:C.createIconNoSpan("filter",this.gos,null),action:()=>this.menuService.showFilterMenu({column:e,buttonElement:o(),containerType:"columnFilter",positionBy:"button"})}:null;case"columnChooser":return E.__isRegistered(A.ColumnsToolPanelModule,this.context.getGridId())?{name:n("columnChooser","Choose Columns"),icon:C.createIconNoSpan("columns",this.gos,null),action:()=>this.menuService.showColumnChooser({column:e,eventSource:o()})}:null;case"sortAscending":return{name:n("sortAscending","Sort Ascending"),icon:C.createIconNoSpan("sortAscending",this.gos,null),action:()=>this.sortController.setSortForColumn(e,"asc",!1,"columnMenu")};case"sortDescending":return{name:n("sortDescending","Sort Descending"),icon:C.createIconNoSpan("sortDescending",this.gos,null),action:()=>this.sortController.setSortForColumn(e,"desc",!1,"columnMenu")};case"sortUnSort":return{name:n("sortUnSort","Clear Sort"),icon:C.createIconNoSpan("sortUnSort",this.gos,null),action:()=>this.sortController.setSortForColumn(e,null,!1,"columnMenu")};default:return console.warn(`AG Grid: unknown menu item type ${t}`),null}}createAggregationSubMenu(t,e){const o=this.localeService.getLocaleTextFunc();let r;if(t.isPrimary())r=t;else{const i=t.getColDef().pivotValueColumn;r=C.exists(i)?i:void 0}const n=[];if(r){const i=r.isValueActive(),s=e.getFuncNames(r);n.push({name:o("noAggregation","None"),action:()=>{this.columnModel.removeValueColumns([r],"contextMenu"),this.columnModel.setColumnAggFunc(r,void 0,"contextMenu")},checked:!i}),s.forEach(a=>{n.push({name:o(a,e.getDefaultFuncLabel(a)),action:()=>{this.columnModel.setColumnAggFunc(r,a,"contextMenu"),this.columnModel.addValueColumns([r],"contextMenu")},checked:i&&r.getAggFunc()===a})})}return n}};l([L("columnModel")],S.prototype,"columnModel",2),l([L("gridApi")],S.prototype,"gridApi",2),l([L("focusService")],S.prototype,"focusService",2),l([L("rowPositionUtils")],S.prototype,"rowPositionUtils",2),l([L("chartMenuItemMapper")],S.prototype,"chartMenuItemMapper",2),l([L("menuService")],S.prototype,"menuService",2),l([L("sortController")],S.prototype,"sortController",2),l([te("clipboardService")],S.prototype,"clipboardService",2),l([te("aggFuncService")],S.prototype,"aggFuncService",2),S=l([_e("menuItemMapper")],S);var Ge="31.3.2";import{Bean as Le,BeanStub as Pe,ModuleNames as Ie,ModuleRegistry as Be,Optional as xe,_ as U}from"@ag-grid-community/core";var w=class extends Pe{getChartItems(t){var e,o;if(!this.chartService){Be.__assertRegistered(Ie.GridChartsModule,`the Context Menu key "${t}"`,this.context.getGridId());return}const r=t==="pivotChart"?new ke(this.gos,this.chartService,this.localeService):new we(this.gos,this.chartService,this.localeService),n=this.chartService.isEnterprise();let i=r.getMenuItem();if(i&&i.subMenu&&!n){const a=c=>{var m;return V(F({},c),{subMenu:(m=c.subMenu)==null?void 0:m.filter(g=>!g._enterprise).map(g=>a(g))})};i=a(i)}const s=(o=(e=this.gos.get("chartToolPanelsDef"))==null?void 0:e.settingsPanel)==null?void 0:o.chartGroupsDef;return s&&(i=w.filterAndOrderChartMenu(i,s,r.getConfigLookup())),this.cleanInternals(i)}cleanInternals(t){if(!t)return t;const e=o=>{var r;return o==null||delete o._key,o==null||delete o._enterprise,(r=o?.subMenu)==null||r.forEach(n=>e(n)),o};return e(t)}static buildLookup(t){let e={};const o=r=>{e[r._key]=r,r.subMenu&&r.subMenu.forEach(n=>o(n))};return o(t),e}static filterAndOrderChartMenu(t,e,o){var r;const n=this.buildLookup(t);let i=V(F({},t),{subMenu:[]});if(Object.entries(e).forEach(([s,a])=>{var c,m;const g=o[s];if(g===null)return;if(g==null){U.warnOnce(`invalid chartGroupsDef config '${s}'`);return}const d=n[g._key];if(d)if(d.subMenu){const p=a.map(u=>{const f=g[u];if(f==null){U.warnOnce(`invalid chartGroupsDef config '${s}.${u}'`);return}return n[f]}).filter(u=>u!==void 0);p.length>0&&(d.subMenu=p,(c=i.subMenu)==null||c.push(d))}else(m=i.subMenu)==null||m.push(d)}),((r=i.subMenu)==null?void 0:r.length)!=0)return i}};l([xe("chartService")],w.prototype,"chartService",2),w=l([Le("chartMenuItemMapper")],w);var ke=class{constructor(t,e,o){this.gos=t,this.chartService=e,this.localeService=o}getMenuItem(){const t=this.localeService.getLocaleTextFunc(),e=(o,r,n,i,s=!1)=>({name:t(o,r),action:()=>this.chartService.createPivotChart({chartType:n}),_key:i,_enterprise:s});return{name:t("pivotChart","Pivot Chart"),_key:"pivotChart",subMenu:[{_key:"pivotColumnChart",name:t("columnChart","Column"),subMenu:[e("groupedColumn","Grouped&lrm;","groupedColumn","pivotGroupedColumn"),e("stackedColumn","Stacked&lrm;","stackedColumn","pivotStackedColumn"),e("normalizedColumn","100% Stacked&lrm;","normalizedColumn","pivotNormalizedColumn")]},{_key:"pivotBarChart",name:t("barChart","Bar"),subMenu:[e("groupedBar","Grouped&lrm;","groupedBar","pivotGroupedBar"),e("stackedBar","Stacked&lrm;","stackedBar","pivotStackedBar"),e("normalizedBar","100% Stacked&lrm;","normalizedBar","pivotNormalizedBar")]},{_key:"pivotPieChart",name:t("pieChart","Pie"),subMenu:[e("pie","Pie&lrm;","pie","pivotPie"),e("donut","Donut&lrm;","donut","pivotDonut")]},e("line","Line&lrm;","line","pivotLineChart"),{_key:"pivotXYChart",name:t("xyChart","X Y (Scatter)"),subMenu:[e("scatter","Scatter&lrm;","scatter","pivotScatter"),e("bubble","Bubble&lrm;","bubble","pivotBubble")]},{_key:"pivotAreaChart",name:t("areaChart","Area"),subMenu:[e("area","Area&lrm;","area","pivotArea"),e("stackedArea","Stacked&lrm;","stackedArea","pivotStackedArea"),e("normalizedArea","100% Stacked&lrm;","normalizedArea","pivotNormalizedArea")]},{_key:"pivotStatisticalChart",_enterprise:!1,name:t("statisticalChart","Statistical"),subMenu:[e("histogramChart","Histogram&lrm;","histogram","pivotHistogram",!1)]},{_key:"pivotHierarchicalChart",_enterprise:!0,name:t("hierarchicalChart","Hierarchical"),subMenu:[e("treemapChart","Treemap&lrm;","treemap","pivotTreemap",!0),e("sunburstChart","Sunburst&lrm;","sunburst","pivotSunburst",!0)]},{_key:"pivotCombinationChart",name:t("combinationChart","Combination"),subMenu:[e("columnLineCombo","Column & Line&lrm;","columnLineCombo","pivotColumnLineCombo"),e("AreaColumnCombo","Area & Column&lrm;","areaColumnCombo","pivotAreaColumnCombo")]}],icon:U.createIconNoSpan("chart",this.gos,void 0)}}getConfigLookup(){return{columnGroup:{_key:"pivotColumnChart",column:"pivotGroupedColumn",stackedColumn:"pivotStackedColumn",normalizedColumn:"pivotNormalizedColumn"},barGroup:{_key:"pivotBarChart",bar:"pivotGroupedBar",stackedBar:"pivotStackedBar",normalizedBar:"pivotNormalizedBar"},pieGroup:{_key:"pivotPieChart",pie:"pivotPie",donut:"pivotDonut",doughnut:"pivotDonut"},lineGroup:{_key:"pivotLineChart",line:"pivotLineChart"},scatterGroup:{_key:"pivotXYChart",bubble:"pivotBubble",scatter:"pivotScatter"},areaGroup:{_key:"pivotAreaChart",area:"pivotArea",stackedArea:"pivotStackedArea",normalizedArea:"pivotNormalizedArea"},combinationGroup:{_key:"pivotCombinationChart",columnLineCombo:"pivotColumnLineCombo",areaColumnCombo:"pivotAreaColumnCombo",customCombo:null},hierarchicalGroup:{_key:"pivotHierarchicalChart",treemap:"pivotTreemap",sunburst:"pivotSunburst"},statisticalGroup:{_key:"pivotStatisticalChart",histogram:"pivotHistogram",rangeBar:null,rangeArea:null,boxPlot:null},polarGroup:null,specializedGroup:null}}},we=class{constructor(t,e,o){this.gos=t,this.chartService=e,this.localeService=o}getMenuItem(){const t=this.localeService.getLocaleTextFunc(),e=(o,r,n,i,s=!1)=>({name:t(o,r),action:()=>this.chartService.createChartFromCurrentRange(n),_key:i,_enterprise:s});return{name:t("chartRange","Chart Range"),_key:"chartRange",subMenu:[{name:t("columnChart","Column"),subMenu:[e("groupedColumn","Grouped&lrm;","groupedColumn","rangeGroupedColumn"),e("stackedColumn","Stacked&lrm;","stackedColumn","rangeStackedColumn"),e("normalizedColumn","100% Stacked&lrm;","normalizedColumn","rangeNormalizedColumn")],_key:"rangeColumnChart"},{name:t("barChart","Bar"),subMenu:[e("groupedBar","Grouped&lrm;","groupedBar","rangeGroupedBar"),e("stackedBar","Stacked&lrm;","stackedBar","rangeStackedBar"),e("normalizedBar","100% Stacked&lrm;","normalizedBar","rangeNormalizedBar")],_key:"rangeBarChart"},{name:t("pieChart","Pie"),subMenu:[e("pie","Pie&lrm;","pie","rangePie"),e("donut","Donut&lrm;","donut","rangeDonut")],_key:"rangePieChart"},e("line","Line&lrm;","line","rangeLineChart"),{name:t("xyChart","X Y (Scatter)"),subMenu:[e("scatter","Scatter&lrm;","scatter","rangeScatter"),e("bubble","Bubble&lrm;","bubble","rangeBubble")],_key:"rangeXYChart"},{name:t("areaChart","Area"),subMenu:[e("area","Area&lrm;","area","rangeArea"),e("stackedArea","Stacked&lrm;","stackedArea","rangeStackedArea"),e("normalizedArea","100% Stacked&lrm;","normalizedArea","rangeNormalizedArea")],_key:"rangeAreaChart"},{name:t("polarChart","Polar"),subMenu:[e("radarLine","Radar Line&lrm;","radarLine","rangeRadarLine"),e("radarArea","Radar Area&lrm;","radarArea","rangeRadarArea"),e("nightingale","Nightingale&lrm;","nightingale","rangeNightingale"),e("radialColumn","Radial Column&lrm;","radialColumn","rangeRadialColumn"),e("radialBar","Radial Bar&lrm;","radialBar","rangeRadialBar")],_key:"rangePolarChart",_enterprise:!0},{name:t("statisticalChart","Statistical"),subMenu:[e("boxPlot","Box Plot&lrm;","boxPlot","rangeBoxPlot",!0),e("histogramChart","Histogram&lrm;","histogram","rangeHistogram",!1),e("rangeBar","Range Bar&lrm;","rangeBar","rangeRangeBar",!0),e("rangeArea","Range Area&lrm;","rangeArea","rangeRangeArea",!0)],_key:"rangeStatisticalChart",_enterprise:!1},{name:t("hierarchicalChart","Hierarchical"),subMenu:[e("treemap","Treemap&lrm;","treemap","rangeTreemap"),e("sunburst","Sunburst&lrm;","sunburst","rangeSunburst")],_key:"rangeHierarchicalChart",_enterprise:!0},{name:t("specializedChart","Specialized"),subMenu:[e("heatmap","Heatmap&lrm;","heatmap","rangeHeatmap"),e("waterfall","Waterfall&lrm;","waterfall","rangeWaterfall")],_key:"rangeSpecializedChart",_enterprise:!0},{name:t("combinationChart","Combination"),subMenu:[e("columnLineCombo","Column & Line&lrm;","columnLineCombo","rangeColumnLineCombo"),e("AreaColumnCombo","Area & Column&lrm;","areaColumnCombo","rangeAreaColumnCombo")],_key:"rangeCombinationChart"}],icon:U.createIconNoSpan("chart",this.gos,void 0)}}getConfigLookup(){return{columnGroup:{_key:"rangeColumnChart",column:"rangeGroupedColumn",stackedColumn:"rangeStackedColumn",normalizedColumn:"rangeNormalizedColumn"},barGroup:{_key:"rangeBarChart",bar:"rangeGroupedBar",stackedBar:"rangeStackedBar",normalizedBar:"rangeNormalizedBar"},pieGroup:{_key:"rangePieChart",pie:"rangePie",donut:"rangeDonut",doughnut:"rangeDonut"},lineGroup:{_key:"rangeLineChart",line:"rangeLineChart"},scatterGroup:{_key:"rangeXYChart",bubble:"rangeBubble",scatter:"rangeScatter"},areaGroup:{_key:"rangeAreaChart",area:"rangeArea",stackedArea:"rangeStackedArea",normalizedArea:"rangeNormalizedArea"},polarGroup:{_key:"rangePolarChart",radarLine:"rangeRadarLine",radarArea:"rangeRadarArea",nightingale:"rangeNightingale",radialColumn:"rangeRadialColumn",radialBar:"rangeRadialBar"},statisticalGroup:{_key:"rangeStatisticalChart",boxPlot:"rangeBoxPlot",histogram:"rangeHistogram",rangeBar:"rangeRangeBar",rangeArea:"rangeRangeArea"},hierarchicalGroup:{_key:"rangeHierarchicalChart",treemap:"rangeTreemap",sunburst:"rangeSunburst"},specializedGroup:{_key:"rangeSpecializedChart",heatmap:"rangeHeatmap",waterfall:"rangeWaterfall"},combinationGroup:{_key:"rangeCombinationChart",columnLineCombo:"rangeColumnLineCombo",areaColumnCombo:"rangeAreaColumnCombo",customCombo:null}}}};import{AgDialog as Re,Autowired as X,Bean as Fe,BeanStub as Ne,Events as De}from"@ag-grid-community/core";import{PrimaryColsPanel as Oe}from"@ag-grid-enterprise/column-tool-panel";var I=class extends Ne{createColumnSelectPanel(t,e,o,r){var n,i;const s=t.createManagedBean(new Oe),a=(i=(n=r??e?.getColDef().columnChooserParams)!=null?n:e?.getColDef().columnsMenuParams)!=null?i:{},{contractColumnSelection:c,suppressColumnExpandAll:m,suppressColumnFilter:g,suppressColumnSelectAll:d,suppressSyncLayoutWithGrid:p,columnLayout:u}=a;return s.init(!!o,this.gos.addGridCommonParams({suppressColumnMove:!1,suppressValues:!1,suppressPivots:!1,suppressRowGroups:!1,suppressPivotMode:!1,contractColumnSelection:!!c,suppressColumnExpandAll:!!m,suppressColumnFilter:!!g,suppressColumnSelectAll:!!d,suppressSyncLayoutWithGrid:!!u||!!p,onStateUpdated:()=>{}}),"columnMenu"),u&&s.setColumnLayout(u),s}showColumnChooser({column:t,chooserParams:e,eventSource:o}){this.hideActiveColumnChooser();const r=this.createColumnSelectPanel(this,t,!0,e),n=this.localeService.getLocaleTextFunc(),i=this.columnModel.getAllDisplayedColumns().indexOf(t),s=t?this.focusService.getFocusedHeader():null;this.activeColumnChooserDialog=this.createBean(new Re({title:n("chooseColumns","Choose Columns"),component:r,width:300,height:300,resizable:!0,movable:!0,centered:!0,closable:!0,afterGuiAttached:()=>{var a;(a=this.focusService.findNextFocusableElement(r.getGui()))==null||a.focus(),this.dispatchVisibleChangedEvent(!0,t)},closedCallback:a=>{const c=this.activeColumnChooser.getGui();this.destroyBean(this.activeColumnChooser),this.activeColumnChooser=void 0,this.activeColumnChooserDialog=void 0,this.dispatchVisibleChangedEvent(!1,t),t&&this.menuUtils.restoreFocusOnClose({column:t,headerPosition:s,columnIndex:i,eventSource:o},c,a,!0)}})),this.activeColumnChooser=r}hideActiveColumnChooser(){this.activeColumnChooserDialog&&this.destroyBean(this.activeColumnChooserDialog)}dispatchVisibleChangedEvent(t,e){const o={type:De.EVENT_COLUMN_MENU_VISIBLE_CHANGED,visible:t,switchingTab:!1,key:"columnChooser",column:e??null};this.eventService.dispatchEvent(o)}};l([X("focusService")],I.prototype,"focusService",2),l([X("menuUtils")],I.prototype,"menuUtils",2),l([X("columnModel")],I.prototype,"columnModel",2),I=l([Fe("columnChooserFactory")],I);import{AgMenuList as Ue,Autowired as R,Bean as Ve,BeanStub as ze,_ as He}from"@ag-grid-community/core";var v=class extends ze{createMenu(t,e,o){const r=t.createManagedBean(new Ue(0,{column:e??null,node:null,value:null})),n=this.getMenuItems(e),i=this.menuItemMapper.mapWithStockItems(n,e??null,o);return r.addMenuItems(i),r}getMenuItems(t){const e=this.getDefaultMenuOptions(t);let o;const r=t?.getColDef().mainMenuItems;if(Array.isArray(r))o=r;else if(typeof r=="function")o=r(this.gos.addGridCommonParams({column:t,defaultItems:e}));else{const n=this.gos.getCallback("getMainMenuItems");n&&t?o=n({column:t,defaultItems:e}):o=e}return He.removeRepeatsFromArray(o,v.MENU_ITEM_SEPARATOR),o}getDefaultMenuOptions(t){const e=[],o=this.menuService.isLegacyMenuEnabled();if(!t)return o||e.push("columnChooser"),e.push("resetColumns"),e;const r=!t.getColDef().lockPinned,n=this.columnModel.getRowGroupColumns().length,i=n>0,s=t.isAllowValue(),a=t.isAllowRowGroup(),c=t.isPrimary(),m=this.columnModel.isPivotMode(),g=this.rowModel.getType()==="clientSide",d=this.gos.get("treeData"),p=c&&i&&s||!c;if(!o&&t.isSortable()){const T=t.getSort();T!=="asc"&&e.push("sortAscending"),T!=="desc"&&e.push("sortDescending"),T&&e.push("sortUnSort"),e.push(v.MENU_ITEM_SEPARATOR)}return this.menuService.isFilterMenuItemEnabled(t)&&(e.push("columnFilter"),e.push(v.MENU_ITEM_SEPARATOR)),r&&e.push("pinSubMenu"),p&&e.push("valueAggSubMenu"),(r||p)&&e.push(v.MENU_ITEM_SEPARATOR),e.push("autoSizeThis"),e.push("autoSizeAll"),e.push(v.MENU_ITEM_SEPARATOR),t.getColDef().showRowGroup?e.push("rowUnGroup"):a&&t.isPrimary()&&(t.isRowGroupActive()?this.columnModel.isColumnGroupingLocked(t)||e.push("rowUnGroup"):e.push("rowGroup")),e.push(v.MENU_ITEM_SEPARATOR),o||e.push("columnChooser"),e.push("resetColumns"),g&&(d||n>(m?1:0))&&(e.push("expandAll"),e.push("contractAll")),e}};v.MENU_ITEM_SEPARATOR="separator",l([R("menuItemMapper")],v.prototype,"menuItemMapper",2),l([R("columnModel")],v.prototype,"columnModel",2),l([R("rowModel")],v.prototype,"rowModel",2),l([R("filterManager")],v.prototype,"filterManager",2),l([R("menuService")],v.prototype,"menuService",2),v=l([Ve("columnMenuFactory")],v);import{Autowired as Y,Bean as We,BeanStub as Xe,_ as oe}from"@ag-grid-community/core";var B=class extends Xe{restoreFocusOnClose(t,e,o,r){const{eventSource:n}=t,i=o instanceof KeyboardEvent;if(!r&&!i||!n)return;const s=this.gos.getDocument(),a=this.gos.getActiveDomElement();!e.contains(a)&&a!==s.body||this.focusHeaderCell(t)}closePopupAndRestoreFocusOnSelect(t,e,o){let r;o&&o.keyboardEvent&&(r=o.keyboardEvent),t(r&&{keyboardEvent:r});const n=this.focusService.getFocusedCell(),i=this.gos.getDocument(),s=this.gos.getActiveDomElement();if(!s||s===i.body)if(n){const{rowIndex:a,rowPinned:c,column:m}=n;this.focusService.setFocusedCell({rowIndex:a,column:m,rowPinned:c,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}else this.focusHeaderCell(e)}onContextMenu(t,e,o){if(!this.gos.get("allowContextMenuWithControlKey")&&t&&(t.ctrlKey||t.metaKey)||(t&&this.blockMiddleClickScrollsIfNeeded(t),this.gos.get("suppressContextMenu")))return;const r=t??e.touches[0];if(o(r)){const n=t??e;n&&n.cancelable&&n.preventDefault()}}focusHeaderCell(t){const{column:e,columnIndex:o,headerPosition:r,eventSource:n}=t;if(this.columnModel.getAllDisplayedColumns().some(s=>s===e)&&n&&oe.isVisible(n)){const s=this.focusService.findTabbableParent(n);s&&(e&&this.headerNavigationService.scrollToColumn(e),s.focus())}else if(r&&o!==-1){const s=this.columnModel.getAllDisplayedColumns(),a=s[o]||oe.last(s);a&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:r.headerRowIndex,column:a}})}}blockMiddleClickScrollsIfNeeded(t){this.gos.get("suppressMiddleClickScrolls")&&t.which===2&&t.preventDefault()}};l([Y("focusService")],B.prototype,"focusService",2),l([Y("headerNavigationService")],B.prototype,"headerNavigationService",2),l([Y("columnModel")],B.prototype,"columnModel",2),B=l([We("menuUtils")],B);var Ye={version:Ge,moduleName:le.MenuModule,beans:[y,_,S,w,I,v,B],dependantModules:[ue]};export{Ye as MenuModule};
